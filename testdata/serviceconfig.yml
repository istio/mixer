subject: namespace:ns
revision: "2022"
rules:
        #- selector: service.name == “*”
        #- selector: service.name == "myservice"
- selector: true
  aspects:
  - kind: quotas
    params:
  - kind: metrics
    adapter: "prometheus"
    params:
      metrics:
      - descriptor: "request_count"
        value: "1" # we want to increment the request_count counter by 1 each time
        labels:
          source: "source.name"
          target: "target.name"
          service: "api.name"
          method: "api.method"
          response_code: "response.http.code"
      - descriptor:  "request_latency"
        value: "response.latency"
        labels:
          source: "source.name"
          target: "target.name"
          service: "api.name"
          method: "api.method"
  - kind: access-logs
    params:
      logName: "access_log"
      logFormat: 0 # Common Log Format
  - kind: application-logs
    params:
      logName: "mixer_log"
      logEntryDescriptorNames: ["default"]
- selector: client.id == "bad_client"
  aspects:
  - kind: denials
